<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>🛠 Générer et mettre à jour JSON</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    #loadingMsg {
      font-style: italic;
      color: #666;
    }
  </style>
</head>
<body class="p-4 bg-light">
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
    <div class="container-fluid">
      <a class="navbar-brand" href="index.html">📊 Gestion des Câbles et Appareils <span id="shipName"></span></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link active" href="index.html">🏠 Accueil</a></li>
          <li class="nav-item"><a class="nav-link" href="cable.html">🔍 Rechercher Câble</a></li>
          <li class="nav-item"><a class="nav-link" href="appareil.html">📡 Rechercher Appareil</a></li>
          <li class="nav-item"><a class="nav-link" href="generate.html">🛠 Générer JSON</a></li>
          <li class="nav-item"><a class="nav-link" href="rd.html">🔎 R&D</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container">
    <h1>🛠 Générer des fichiers JSON depuis un fichier NEC (.xlsb)</h1>
    <p>
      Cette page vous permet de créer un JSON par colonne d’intérêt à partir de la feuille <code>Cables</code> de votre fichier <code>.xlsb</code>.<br>
      <strong>Plus tard</strong>, elle servira à mettre à jour le site en se connectant à
      <a href="https://github.com/A36-coder/navire2/tree/main/json" target="_blank">A36-coder/navire2/json</a>.
    </p>

    <!-- Bouton pour télécharger le fichier NEC -->
    <a id="downloadNecLink" class="btn btn-outline-secondary mb-3" target="_blank" download>
      📥 Télécharger le fichier NEC (.xlsb)
    </a>
    <p>
    Si le nec n'est pas le bon, vous trouverez l'ensemble des fichier NEC en cliquant sur le lien suivant:<br>
      <a href="https://share.chantiers-atlantique.com/share/page/repository#filter=path%7C%2FChantiers%2520de%2520l%2527Atlantique%2FConception%2520G%25E9n%25E9rale%2520et%2520D%25E9taill%25E9e%2F03%2520METIERS%2F4%2520Electricit%25E9%2F02%2520-%2520Supports%2FBDEL%2520-%2520IELEC%2520%2528extraction%2520donn%25E9es%2529%2FBord%7C&page=1" target="_blank">Tous les NEC</a>.
    </p>
    

    <!-- Input file pour charger localement -->
    <input type="file" id="fileInput" accept=".xlsb, .xlsx" class="form-control mb-3">

    <div id="message"></div>
    <div id="loadingMsg"></div>
    <div id="downloadLinks" class="mt-4"></div>
    <button id="downloadAllBtn" class="btn btn-success mt-3" disabled>Télécharger tout en ZIP</button>
  </div>

  <script src="config_changement_navire.js"></script>
  <script src="script.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById("downloadNecLink").href = window.LINKS.NEC_DOWNLOAD;
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
